---
import Layout from "../layouts/Layout.astro"
import "../styles/global.css"
---

<Layout titulo="Inicio" descripcion="Bienvenido a League Base. Crea un torneo en minutos, sin registro.">
    <main class="flex flex-col md:flex-row items-center justify-evenly gap-10">
        <div class="flex flex-col items-center justify-center shadow-sm bg-linear-to-t from-slate-950 to-slate-900 rounded-2xl pt-4 w-10/12 lg:w-5/12 my-10">
            <h1 class="text-3xl">Crear Torneo o Liga</h1>
            <form class="p-8 w-full max-w-[600px]">        
                <label for="nombre" class="text-primario">Nombre del torneo o liga</label>
                <input type="text" id="nombre" name="nombre" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" autocomplete="name" required />
                
                <label for="tipo">Tipo</label>
                <select id="tipo" name="tipo" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8">
                    <option value="liga" class="text-black">Liga</option>
                    <option value="torneo" class="text-black">Torneo</option>
                </select>

                <div class="flex gap-4 md:flex-row flex-col">
                    <div>
                        <label for="fecha_inicio">Fecha de inicio del torneo</label>
                        <input type="date" name="fecha_inicio" id="fecha_inicio" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" required />
                    </div>

                    <div>
                        <label for="fecha_fin">Fecha de fin del torneo</label>
                        <input type="date" name="fecha_fin" id="fecha_fin" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" required />
                    </div>
                </div>

                <label for="logo">Logo del torneo</label>
                <input type="file" id="logo" name="logo" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" accept="image/*" required />

                <label for="jugadores_equipo">Minimo de jugadores por equipo</label>
                <input type="number" id="jugadores_equipo" name="jugadores_equipo" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" min="1" max="25" value="1" required />

                <label for="ubicacion">Ubicacion</label>
                <input type="text" id="ubicacion" name="ubicacion" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" required />

                <label for="descripcion">Descripci√≥n</label>
                <textarea id="descripcion" name="descripcion" class="pl-2 mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring transition-all focus:ring-blue-500 mb-8" rows="4" required></textarea>

                <input type="submit" value="Crear Torneo o Liga" class="w-full bg-blue-600 text-white px-4 py-2 rounded-md cursor-pointer hover:bg-blue-700 transition-all" />
            </form>
        </div>
    </main>
</Layout>

<script>
    window.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form') as HTMLFormElement;
        const boton = document.querySelector('input[type="submit"]') as HTMLInputElement;
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            boton.disabled = true;
            const datosFormulario = new FormData(form);
            const objetoDatos = Object.fromEntries(datosFormulario.entries());

            if (objetoDatos.fecha_inicio && objetoDatos.fecha_fin) {
                const fechaInicio = new Date(String(objetoDatos.fecha_inicio));
                const fechaFin = new Date(String(objetoDatos.fecha_fin));
                const fechaActual = new Date();

                if (fechaFin < fechaActual) {
                    alert('La fecha de fin no puede ser anterior a la fecha actual.');
                }

                if (fechaInicio > fechaFin) {
                    alert('La fecha de inicio debe ser anterior a la fecha de fin.');
                }
                if (fechaInicio < fechaActual) {
                    alert('La fecha de inicio no puede ser anterior a la fecha actual.');
                }
            }
            if (!objetoDatos.nombre || !objetoDatos.tipo || !objetoDatos.fecha_inicio || !objetoDatos.fecha_fin || !objetoDatos.logo || !objetoDatos.jugadores_equipo || !objetoDatos.ubicacion || !objetoDatos.descripcion) {
                alert('Por favor, completa todos los campos.');
            }
            
            boton.disabled = false;
        })

    });
</script>